<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.project3.yogiaudio.repository.interfaces.AdminRepository">

<insert id="insertNotice">
	insert into board_notice set
					writer_id = #{writerId},
                    title = #{title},
                    content = #{content},
                    file_path = #{filePath},
                    created_at = now()
</insert>

<!-- <insert id="insertNoticeFile">
	insert into filedb set
				uuid = '1',
                original_file_name = 'test.jpg'
</insert> -->

<select id="findAllUser" resultType="com.project3.yogiaudio.repository.entity.User">
	<!-- offset 속성 Criteria의 getOffset() 메서드로 받을 수 있음 -->
	select * from user order by id desc limit #{offset}, #{pageSize} 
</select>

<select id="countAllUser" resultType="int">
	select count(*) from user
</select>

<select id="findAllMusic" resultType="com.project3.yogiaudio.repository.entity.Music">
	<!-- pageSize에 고정값 넣으니까 4페이지 11개 인데 5페이지 1개가 표시됨-->
	select * from music order by music_no desc limit ${offset}, #{pageSize} 
</select>

<select id="countAllMusic" resultType="int">
	select count(*) from music
</select>

<select id="findAllNotice" resultType="com.project3.yogiaudio.repository.entity.board.BoardNotice">
	select a.*, b.name as writerName from board_notice as a
	left join user as b <!-- left join -->
	on a.writer_id = b.id
	order by id desc limit ${offset}, #{pageSize}
</select>

<select id="countAllNotice" resultType="int">
	select count(*) from board_notice
</select>

<select id="findAllQna" resultType="com.project3.yogiaudio.repository.entity.board.BoardQna">
	select a.*, b.name as writerName from board_qna as a
	left join user as b
	on a.writer_id = b.id
	order by a.id desc limit #{offset}, #{pageSize}
</select>

<select id="countAllQna" resultType="int">
	select count(*) from board_qna
</select>
	
<delete id="deleteUser">
	delete from user where id=#{id}
</delete>
	
<delete id="deleteMusic">
	delete from music where music_no = #{musicNo}
</delete>
	
<delete id="deleteNotice">
	delete from board_notice where id=#{id}
</delete>
	
<delete id="deleteQna">
	delete from board_qna where id=#{id}
</delete>	


	


</mapper>