<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper
	namespace="com.project3.yogiaudio.repository.interfaces.board.QnaRepository">

	<insert id="insertQna">
		insert into board_qna (writer_id, title, content, file_path) <!-- db -->
		values (#{writerId}, #{title}, #{content}, #{filePath}) <!--entity = 파라미터값과 
			같아야 함 -->
	</insert>

	<select id="findAllByKeywordwithPasing"
		resultType="com.project3.yogiaudio.repository.entity.board.BoardQna">
		select a.*, b.name as writerName from board_qna as a
		left join `user` as b
		on a.writer_id = b.id
		<if test="searchType == 'title'">
			where title like CONCAT('%',#{searchInput},'%')
		</if>
		<if test="searchType == 'content'">
			where content like CONCAT('%',#{searchInput},'%')
		</if>
		<if test="searchType == 'createdAt'">
			where created_at like CONCAT('%',#{searchInput},'%')
		</if>
		<if test="searchType == null">
			<!-- If no search type is specified, fetch all records -->
		</if>
		order by id desc
		limit #{limit} offset #{offset}
	</select>

	<select id="getAllPageCount" resultType="int">
		select count(*) from
		board_qna
		<if test="searchType == 'title'">
			where title like CONCAT('%',#{searchInput},'%')
		</if>
		<if test="searchType == 'content'">
			where content like CONCAT('%',#{searchInput},'%')
		</if>
		<if test="searchType == 'createdAt'">
			where created_at like CONCAT('%',#{searchInput},'%')
		</if>
		<if test="searchType == null">
			<!-- If no search type is specified, fetch all records -->
		</if>
	</select>

	<select id="findById"
		resultType="com.project3.yogiaudio.repository.entity.board.BoardQna">
		SELECT * FROM board_qna WHERE id = #{id};
	</select>

	<update id="qnaUpdate">
		update board_qna set title = #{title}, content =
		#{content}, file_path = #{filePath} WHERE id = #{id};
	</update>

	<delete id="qnaDelete">
		delete from board_qna WHERE id = #{id};
	</delete>

</mapper>